webpackJsonp([12],{ij6f:function(t,e){},weal:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("7t+N"),a=s.n(i),n={name:"re-application",data:function(){return{applicationStatus:!1,reimbursement:[{name:"起止日期",id:"expense_date",type:"text",error:!1},{name:"费用类型",id:"expense_type",type:"text",error:!1},{name:"费用描述",id:"expense_description",type:"text",error:!1},{name:"发票索引",id:"receipt_reference",type:"text",error:!1},{name:"发票金额",id:"receipt_amount",type:"text",error:!1}],inputIndex:-1,year:0,month:0,day:0,tempYear:0,tempMonth:0,tempDay:0,time:0,posY:0,typeList:["市内交通费","在途费用","差旅补贴"],typeIndex:-1,tempTypeIndex:-1,number:0}},methods:{application:function(){a.a.ajax({async:!1,url:"/expense_application/",type:"POST",data:{expense_date:a()("#expense_date").val(),expense_description:a()("#expense_description").val(),expense_type:a()("#expense_type").val(),receipt_reference:a()("#receipt_reference").val(),receipt_currency:"CNY",receipt_amount:a()("#receipt_amount").val(),exchange_rate:1,converted_amount:a()("#converted_amount").val(),csrfmiddlewaretoken:csrf_token},success:function(t){alert(t)}})},setValue:function(t){var e;switch(this.inputIndex=t,t>1&&a()(".money-item input").eq(t).focus(),t){case 0:a()(".money-item input").eq(t).blur(),this.tempYear=this.year,this.tempMonth=this.month,this.tempDay=this.day,this.$root.eventHub.$emit("prompt");break;case 1:a()(".money-item input").eq(t).blur(),""===a()(".money-item input").eq(1).val()&&(this.typeIndex=1),this.tempTypeIndex=this.typeIndex,this.$root.eventHub.$emit("prompt");break;case 2:this.$root.adapt||(e=a()("#main").height()+174,a()("#app").animate({scrollTop:e},400));break;case 3:this.$root.adapt||(e=a()("#main").height()+232,a()("#app").animate({scrollTop:e},400));break;case 4:this.$root.adapt||(e=a()("#main").height()+290,a()("#app").animate({scrollTop:e},400)),""!==event.target.value&&a()(".money-item input").eq(4).val(this.number)}},setYear:function(t){switch(t.preventDefault(),t.stopPropagation(),t||(t=window.event),t.type){case"touchstart":this.posY=t.targetTouches[0].pageY;break;case"touchmove":var e=t.targetTouches[0].pageY-this.posY;(e>30||e<-30)&&((this.tempYear%4==0&&this.tempYear%100!=0||this.tempYear%400==0)&&2===this.tempMonth&&29===this.tempDay&&(this.tempDay=28),e>30?(this.posY=t.targetTouches[0].pageY,this.tempYear--):e<-30&&(this.posY=t.targetTouches[0].pageY,this.tempYear++))}},setYear2:function(t){if(this.$root.adapt)switch(t){case 0:(this.tempYear%4==0&&this.tempYear%100!=0||this.tempYear%400==0)&&2===this.tempMonth&&29===this.tempDay&&(this.tempDay=28),this.tempYear--;break;case 2:(this.tempYear%4==0&&this.tempYear%100!=0||this.tempYear%400==0)&&2===this.tempMonth&&29===this.tempDay&&(this.tempDay=28),this.tempYear++}},setMonth:function(t){switch(t.preventDefault(),t.stopPropagation(),t||(t=window.event),t.type){case"touchstart":this.posY=t.targetTouches[0].pageY;break;case"touchmove":var e=t.targetTouches[0].pageY-this.posY;e>30?(this.posY=t.targetTouches[0].pageY,this.tempMonth--,this.tempDay>this.getDaysInMonth(this.year,this.tempMonth)&&(this.tempDay=this.getDaysInMonth(this.year,this.tempMonth)),0===this.tempMonth&&(this.tempYear--,this.tempMonth=12)):e<-30&&(this.posY=t.targetTouches[0].pageY,this.tempMonth++,this.tempDay>this.getDaysInMonth(this.year,this.tempMonth)&&(this.tempDay=this.getDaysInMonth(this.year,this.tempMonth)),13===this.tempMonth&&(this.tempDay===this.getDaysInMonth(this.year,12)&&(this.tempDay=1),this.tempYear++,this.tempMonth=1))}},setMonth2:function(t){if(this.$root.adapt)switch(t){case 0:this.tempMonth--,this.tempDay>this.getDaysInMonth(this.year,this.tempMonth)&&(this.tempDay=this.getDaysInMonth(this.year,this.tempMonth)),0===this.tempMonth&&(this.tempYear--,this.tempMonth=12);break;case 2:this.tempMonth++,this.tempDay>this.getDaysInMonth(this.year,this.tempMonth)&&(this.tempDay=this.getDaysInMonth(this.year,this.tempMonth)),13===this.tempMonth&&(this.tempDay===this.getDaysInMonth(this.year,12)&&(this.tempDay=1),this.tempYear++,this.tempMonth=1)}},setDay:function(t){switch(t.preventDefault(),t.stopPropagation(),t||(t=window.event),t.type){case"touchstart":this.posY=t.targetTouches[0].pageY;break;case"touchmove":var e=t.targetTouches[0].pageY-this.posY;e>30?(this.posY=t.targetTouches[0].pageY,this.tempDay--,0===this.tempDay&&(1===this.tempMonth?(this.tempYear--,this.tempMonth=12):this.tempMonth--,this.tempDay=this.getDaysInMonth(this.tempYear,this.tempMonth))):e<-30&&(this.posY=t.targetTouches[0].pageY,this.tempDay++,this.tempDay>this.getDaysInMonth(this.tempYear,this.tempMonth)&&(this.tempDay=1,12===this.tempMonth?(this.tempYear++,this.tempMonth=1):this.tempMonth++))}},setDay2:function(t){if(this.$root.adapt)switch(t){case 0:this.tempDay--,0===this.tempDay&&(1===this.tempMonth?(this.tempYear--,this.tempMonth=12):this.tempMonth--,this.tempDay=this.getDaysInMonth(this.tempYear,this.tempMonth));break;case 2:this.tempDay++,this.tempDay>this.getDaysInMonth(this.tempYear,this.tempMonth)&&(this.tempDay=1,12===this.tempMonth?(this.tempYear++,this.tempMonth=1):this.tempMonth++)}},setType:function(t){switch(t.preventDefault(),t.stopPropagation(),t||(t=window.event),t.type){case"touchstart":this.posY=t.targetTouches[0].pageY;break;case"touchmove":var e=t.targetTouches[0].pageY-this.posY;e>40?(this.posY=t.targetTouches[0].pageY,this.tempTypeIndex>0?this.tempTypeIndex--:this.tempTypeIndex=0):e<-40&&(this.posY=t.targetTouches[0].pageY,this.tempTypeIndex<2?this.tempTypeIndex++:this.tempTypeIndex=2)}},setType2:function(t){if(this.$root.adapt)switch(t){case 0:this.tempTypeIndex>0&&this.tempTypeIndex--;break;case 2:this.tempTypeIndex<2&&this.tempTypeIndex++}},inputValue:function(t){switch(t){case 4:this.number=event.target.value}},showValue:function(t){switch(""!==event.target.value&&(this.reimbursement[t].error=!1),t){case 2:case 3:this.inputIndex=-1;break;case 4:this.inputIndex=-1,""===event.target.value&&(this.number=0),event.target.value=this.number+" 元"}},getCurrentDate:function(){var t=new Date;this.year=t.getFullYear(),this.month=t.getMonth()+1,this.day=t.getDate()},getDaysInMonth:function(t,e){return new Date(t,e,0).getDate()},input:function(){switch(this.reimbursement[this.inputIndex].error=!1,this.inputIndex){case 0:this.year=this.tempYear,this.month=this.tempMonth,this.day=this.tempDay,a()(".money-item input").eq(0).val(this.year+"年"+this.month+"月"+this.day+"日");break;case 1:this.typeIndex=this.tempTypeIndex,a()(".money-item input").eq(1).val(this.typeList[this.typeIndex])}this.$root.eventHub.$emit("prompt"),this.hideModal()},cancelInput:function(){this.$root.eventHub.$emit("prompt"),this.hideModal()},hideModal:function(){this.inputIndex=-1},modalHeight:function(t){var e;switch(t){case 0:case 1:e=265}return"height: "+e+"px"},renderPlace:function(t){switch(t){case 0:return"请输入活动日期";case 1:return"请选择费用类型";case 2:case 3:return"必填";case 4:return"例: 30元"}},submit:function(){for(var t=!0,e=a()(".money-item input"),s=0;s<e.length;s++)""===e[s].value&&(this.reimbursement[s].error=!0,t=!1);if(t){var i=this.year+"."+this.month+"."+this.day,n=(1*this.number).toFixed(2),h=this;a.a.ajax({async:!1,url:"/expense_application/",type:"POST",data:{expense_date:i,expense_description:a()(".money-item input").eq(2).val(),expense_type:a()(".money-item input").eq(1).val(),receipt_reference:a()(".money-item input").eq(3).val(),receipt_currency:"CNY",receipt_amount:n,exchange_rate:1,converted_amount:n,csrfmiddlewaretoken:csrf_token},success:function(t){var e;"success"===t?(e={text:"成功提交报销申请！",duration:1e3},h.$root.eventHub.$emit("showPrompt",e),h.$router.push({path:"/user/reimbursement"})):(e={text:"提交失败！",duration:1e3},h.$root.eventHub.$emit("showPrompt",e))}})}else{this.$root.eventHub.$emit("showPrompt",{text:"请输入完整的报销信息！",duration:1200})}}},computed:{renderYear:function(){for(var t=[],e=this.tempYear-1;e<=this.tempYear+1;e++)t.push(e);return t},renderMonth:function(){for(var t=[],e=this.tempMonth-1;e<=this.tempMonth+1;e++)0===e?t.push(12):13===e?t.push(1):t.push(e);return t},renderDay:function(){for(var t=[],e=this.tempDay-1;e<=this.tempDay+1;e++)0===e?1===this.tempMonth?t.push(this.getDaysInMonth(this.tempYear-1,12)):t.push(this.getDaysInMonth(this.tempYear,this.tempMonth-1)):e>this.getDaysInMonth(this.tempYear,this.tempMonth)?t.push(1):t.push(e);return t},renderType:function(){var t,e=[];switch(this.tempTypeIndex){case 0:e.push(""),e.push(this.typeList[0]),e.push(this.typeList[1]);break;case 1:for(t=0;t<3;t++)e.push(this.typeList[t]);break;case 2:e.push(this.typeList[1]),e.push(this.typeList[2]),e.push("")}return e}},mounted:function(){var t=this;this.applicationStatus=!0,this.getCurrentDate(),this.$root.eventHub.$on("cancelPrompt",function(){-1!==t.inputIndex&&t.hideModal()})}},h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"reapplication"}},[s("transition",{attrs:{name:"funcList"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.applicationStatus,expression:"applicationStatus"}],staticClass:"func-operation"},[t._l(t.reimbursement,function(e,i){return s("div",{key:i,staticClass:"money-item",class:{error:e.error,active:t.inputIndex===i},on:{click:function(e){t.setValue(i)}}},[s("p",{staticClass:"left"},[t._v(t._s(e.name))]),t._v(" "),s("input",{attrs:{type:e.type,placeholder:t.renderPlace(i)},on:{input:function(e){t.inputValue(i)},blur:function(e){t.showValue(i)}}})])}),t._v(" "),s("div",{staticClass:"pointer",attrs:{id:"submit"},on:{click:t.submit}},[t._v("提交")])],2)]),t._v(" "),s("transition",{attrs:{name:"modal"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:0===t.inputIndex,expression:"inputIndex === 0"}],staticClass:"picker",style:t.modalHeight(0)},[s("p",[t._v("请选择时间")]),t._v(" "),s("div",{staticClass:"date-wrapper"},[s("div",{staticClass:"year date pointer",on:{touchstart:t.setYear,touchmove:t.setYear,touchend:t.setYear}},[t._l(t.renderYear,function(e,i){return s("div",{key:i,on:{click:function(e){t.setYear2(i)}}},[s("p",[t._v(t._s(e)+" 年")])])}),t._v(" "),s("div",{staticClass:"center-line"})],2),t._v(" "),s("div",{staticClass:"month date pointer",on:{touchstart:t.setMonth,touchmove:t.setMonth,touchend:t.setMonth}},[t._l(t.renderMonth,function(e,i){return s("div",{key:i,on:{click:function(e){t.setMonth2(i)}}},[s("p",[t._v(t._s(e)+" 月")])])}),t._v(" "),s("div",{staticClass:"center-line"})],2),t._v(" "),s("div",{staticClass:"day date pointer",on:{touchstart:t.setDay,touchmove:t.setDay,touchend:t.setDay}},[t._l(t.renderDay,function(e,i){return s("div",{key:i,on:{click:function(e){t.setDay2(i)}}},[s("p",[t._v(t._s(e)+" 日")])])}),t._v(" "),s("div",{staticClass:"center-line"})],2)]),t._v(" "),s("div",{staticClass:"choices"},[s("div",{attrs:{id:"date-cancel"},on:{click:t.cancelInput}},[t._v("取消")]),t._v(" "),s("div",{attrs:{id:"date-submit"},on:{click:t.input}},[t._v("确定")])])])]),t._v(" "),s("transition",{attrs:{name:"modal"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:1===t.inputIndex,expression:"inputIndex === 1"}],staticClass:"picker",style:t.modalHeight(1)},[s("p",[t._v("请选择类型")]),t._v(" "),s("div",{staticClass:"type-wrapper"},[s("div",{staticClass:"type pointer",on:{touchstart:t.setType,touchmove:t.setType,touchend:t.setType}},[t._l(t.renderType,function(e,i){return s("div",{key:i,on:{click:function(e){t.setType2(i)}}},[s("p",[t._v(t._s(e))])])}),t._v(" "),s("div",{staticClass:"center-line"})],2)]),t._v(" "),s("div",{staticClass:"choices"},[s("div",{attrs:{id:"type-cancel"},on:{click:t.cancelInput}},[t._v("取消")]),t._v(" "),s("div",{attrs:{id:"type-submit"},on:{click:t.input}},[t._v("确定")])])])])],1)},staticRenderFns:[]};var p=s("VU/8")(n,h,!1,function(t){s("ij6f")},"data-v-452c3434",null);e.default=p.exports}});
//# sourceMappingURL=12.576fecc1996705f84147.js.map